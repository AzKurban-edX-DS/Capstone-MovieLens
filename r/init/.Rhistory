length(romance_idx)
#> [1] 3
romance_idx
#> [1]   926   955  2341  4560 10220
romance_titles
#         titles                   genres
# 754 Sleepless in Seattle (1993)     Comedy|Drama|Romance
# 818      You've Got Mail (1998)           Comedy|Romance
# 960        Groundhog Day (1993)   Comedy|Fantasy|Romance
# str(train_set)
# str(test_set)
romance_sample <- train_set |>
group_by(movieId) |>
summarise(genres = first(genres), title = first(title), count = n()) |>
inner_join(data.frame(movieId = names(b_reg[romance_idx])),
by = "movieId")
# str(romance_sample)
romance_sample
#   movieId genres                   title                       count
#   <chr>   <chr>                    <chr>                       <int>
# 2 539     Comedy|Drama|Romance     Sleepless in Seattle (1993)  7069
# 3 1265    Comedy|Fantasy|Romance   Groundhog Day (1993)         9548
# 4 2424    Comedy|Romance           You've Got Mail (1998)       3574
library(gridExtra)
prm12 <- qplot(r[,romance_idx[1]],
r[,romance_idx[2]],
xlab = romance_titles[1],
ylab = romance_titles[2])
prm23 <- qplot(r[,romance_idx[2]],
r[,romance_idx[3]],
xlab = romance_titles[2],
ylab = romance_titles[3])
prm13 <- qplot(r[,romance_idx[1]],
r[,romance_idx[3]],
xlab = romance_titles[1],
ylab = romance_titles[3])
grid.arrange(prm12, prm23 ,prm13, ncol = 3)
# Mob movies sample ---------------------------
crime_movie_titles_idx <- str_detect(movie_titles$genres, "Crime")
movie_titles[str_detect(movie_titles$titles, "Goodfellas"),]
#                titles      genres
# 610 Goodfellas (1990) Crime|Drama
goodfellars_idx <- crime_movie_titles_idx &
str_detect(movie_titles$titles, "Goodfellas")
sum(goodfellars_idx)
#> [1] 1
godfather_idx <- crime_movie_titles_idx &
str_detect(movie_titles$titles, "Godfather")
sum(godfather_idx)
#> [1] 3
mob_sample_idx <- goodfellars_idx | godfather_idx
sum(mob_sample_idx)
#> [1] 4
mob_titles <- movie_titles$titles[mob_sample_idx]
mob_idx <- which(mob_sample_idx)
length(mob_idx)
#> [1] 4
mob_idx
#> [1]   926   955  2341
mob_titles
# [1] "Godfather, The (1972)"           "Godfather: Part II, The (1974)"
# [3] "Godfather: Part III, The (1990)"
# library(gridExtra)
pmb12 <- qplot(r[,mob_idx[1]],
r[,mob_idx[2]],
xlab = mob_titles[1],
ylab = mob_titles[2])
pmb23 <- qplot(r[,mob_idx[2]],
r[,mob_idx[3]],
xlab = mob_titles[2],
ylab = mob_titles[3])
pmb13 <- qplot(r[,mob_idx[1]],
r[,mob_idx[3]],
xlab = mob_titles[1],
ylab = mob_titles[3])
grid.arrange(pmb12, pmb23 ,pmb13, ncol = 3)
pr1_m1 <- qplot(r[,romance_idx[1]],
r[,mob_idx[1]],
xlab = romance_titles[1],
ylab = mob_titles[1])
pr2_m2 <- qplot(r[,romance_idx[2]],
r[,mob_idx[2]],
xlab = romance_titles[2],
ylab = mob_titles[2])
pr3_m3 <- qplot(r[,romance_idx[3]],
r[,mob_idx[3]],
xlab = romance_titles[3],
ylab = mob_titles[3])
grid.arrange(pr1_m1, pr2_m2 ,pr3_m3, ncol = 3)
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
head(movie_titles[romance_movie_titles_idx, 1])
head(movie_titles[romance_movie_titles_idx, 1])
vampire_in_brooklyn_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Vampire in Brooklyn (1995)")
sum(vampire_in_brooklyn_idx)
movie_titles[str_detect(movie_titles$titles, "Vampire in Brooklyn (1995)"),]
head(movie_titles[romance_movie_titles_idx,])
movie_titles[str_detect(movie_titles$titles, "Vampire in Brooklyn (1995)"),]
movie_titles[str_detect(movie_titles$titles, "Vampire in Brooklyn"),]
vampire_in_brooklyn_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Vampire in Brooklyn")
sum(vampire_in_brooklyn_idx)
# Romance movies sample ------------------
romance_movie_titles_idx <- str_detect(movie_titles$genres, "Romance")
# scent_of_woman_idx <- romance_movie_titles_idx &
#   str_detect(movie_titles$titles, "Scent of a Woman")
#
# sum(scent_of_woman_idx)
# #> [1] 0
you_ve_got_mail_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "You've Got Mail")
sum(you_ve_got_mail_idx)
#> [1] 1
sleepless_in_seattle_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Sleepless in Seattle")
sum(sleepless_in_seattle_idx)
#> [1] 1
head(movie_titles[romance_movie_titles_idx,])
#                                titles                  genres
# 8                     Clueless (1995)          Comedy|Romance
# 11         Vampire in Brooklyn (1995)          Comedy|Romance
# 14                   Desperado (1995) Action|Romance|Thriller
# 22              Before Sunrise (1995)           Drama|Romance
# 37 Four Weddings and a Funeral (1994)          Comedy|Romance
# 40               Reality Bites (1994)    Comedy|Drama|Romance
#movie_titles[str_detect(movie_titles$titles, "Vampire in Brooklyn"),]
#                        titles         genres
# 11 Vampire in Brooklyn (1995) Comedy|Romance
vampire_in_brooklyn_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Vampire in Brooklyn")
sum(vampire_in_brooklyn_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
vampire_in_brooklyn_idx
sum(romance_movie_idx)
#> [1] 3
romance_titles <- movie_titles[romance_movie_idx, 1]
romance_idx <- which(romance_movie_idx)
length(romance_idx)
#> [1] 3
romance_idx
#> [1]   754 818 960
romance_titles
#         titles                   genres
# 754 Sleepless in Seattle (1993)     Comedy|Drama|Romance
# 818      You've Got Mail (1998)           Comedy|Romance
# 960        Groundhog Day (1993)   Comedy|Fantasy|Romance
# str(train_set)
# str(test_set)
romance_sample <- train_set |>
group_by(movieId) |>
summarise(genres = first(genres), title = first(title), count = n()) |>
inner_join(data.frame(movieId = names(b_reg[romance_idx])),
by = "movieId")
# str(romance_sample)
romance_sample
#   movieId genres                   title                       count
#   <chr>   <chr>                    <chr>                       <int>
# 2 539     Comedy|Drama|Romance     Sleepless in Seattle (1993)  7069
# 3 1265    Comedy|Fantasy|Romance   Groundhog Day (1993)         9548
# 4 2424    Comedy|Romance           You've Got Mail (1998)       3574
library(gridExtra)
prm12 <- qplot(r[,romance_idx[1]],
r[,romance_idx[2]],
xlab = romance_titles[1],
ylab = romance_titles[2])
prm23 <- qplot(r[,romance_idx[2]],
r[,romance_idx[3]],
xlab = romance_titles[2],
ylab = romance_titles[3])
prm13 <- qplot(r[,romance_idx[1]],
r[,romance_idx[3]],
xlab = romance_titles[1],
ylab = romance_titles[3])
grid.arrange(prm12, prm23 ,prm13, ncol = 3)
# Romance vs Mob movies sample ---------------------------
pr1_m1 <- qplot(r[,romance_idx[1]],
r[,mob_idx[1]],
xlab = romance_titles[1],
ylab = mob_titles[1])
pr2_m2 <- qplot(r[,romance_idx[2]],
r[,mob_idx[2]],
xlab = romance_titles[2],
ylab = mob_titles[2])
pr3_m3 <- qplot(r[,romance_idx[3]],
r[,mob_idx[3]],
xlab = romance_titles[3],
ylab = mob_titles[3])
grid.arrange(pr1_m1, pr2_m2 ,pr3_m3, ncol = 3)
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
romance_titles
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Clueless")
sum(unknown_romance_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
romance_titles <- movie_titles[romance_movie_idx, 1]
romance_idx <- which(romance_movie_idx)
length(romance_idx)
#> [1] 3
romance_idx
romance_titles
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Desperado")
sum(unknown_romance_idx)
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
romance_titles <- movie_titles[romance_movie_idx, 1]
romance_idx <- which(romance_movie_idx)
length(romance_idx)
#> [1] 3
romance_idx
#> [1]   754 818 960
romance_titles
romance_titles <- movie_titles[romance_movie_idx]
romance_titles <- movie_titles[romance_movie_idx,]
romance_idx <- which(romance_movie_idx)
length(romance_idx)
#> [1] 3
romance_idx
#> [1]   754 818 960
romance_titles
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Before Sunrise")
sum(unknown_romance_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
#         titles                   genres
# 754 Sleepless in Seattle (1993)     Comedy|Drama|Romance
# 818      You've Got Mail (1998)           Comedy|Romance
# 960        Groundhog Day (1993)   Comedy|Fantasy|Romance
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance_idx <- which(romance_movie_idx)
length(romance_idx)
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
romance123 <- r[, c(romance_idx[4], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Four Weddings and a Funeral")
sum(unknown_romance_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance_idx <- which(romance_movie_idx)
romance_idx
#> [1]   754 818 960
length(romance_idx)
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Reality Bites")
sum(unknown_romance_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance_idx <- which(romance_movie_idx)
romance_idx
#> [1]   754 818 960
length(romance_idx)
romance123 <- r[, c(romance_idx[1], romance_idx[2], romance_idx[3])]
colnames(romance123) <-
c(romance_titles[1], romance_titles[2], romance_titles[3])
#str(romance123)
cor(romance123,
use="pairwise.complete") |>
knitr::kable()
romance_titles
cor(r[, romance_idx],
use="pairwise.complete") |>
knitr::kable()
romance_sample <- r[, romance_idx]
colnames(romance_sample) <- romance_titles
cor(romance_sample,
use="pairwise.complete") |>
knitr::kable()
unknown_romance_idx
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
movie_titles[romance_movie_titles_idx,]
unknown_romance_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Look Who's Talking Now")
sum(unknown_romance_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
unknown_romance_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance_idx <- which(romance_movie_idx)
romance_idx
#> [1]   754 818 960
length(romance_idx)
romance_sample <- r[, romance_idx]
colnames(romance_sample) <- romance_titles
cor(romance_sample,
use="pairwise.complete") |>
knitr::kable()
look_who_is_talking_now_idx <- romance_movie_titles_idx &
str_detect(movie_titles$titles, "Look Who's Talking Now")
sum(look_who_is_talking_now_idx)
#> [1] 1
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
look_who_is_talking_now_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
romance_idx <- which(romance_movie_idx)
romance_idx
prm12 <- qplot(r[,romance_idx[1]],
r[,romance_idx[2]],
xlab = romance_titles[1],
ylab = romance_titles[2])
prm23 <- qplot(r[,romance_idx[2]],
r[,romance_idx[3]],
xlab = romance_titles[2],
ylab = romance_titles[3])
prm13 <- qplot(r[,romance_idx[1]],
r[,romance_idx[3]],
xlab = romance_titles[1],
ylab = romance_titles[3])
grid.arrange(prm12, prm23 ,prm13, ncol = 3)
idx <- c(mob_idx[1], mob_idx[2], mob_idx[3],
romance_idx[1], romance_idx[2], romance_idx[3])
mob123_romance123 <- r[, idx]
colnames(mob123_romance123) <-
c(mob_titles[1], mob_titles[2], mob_titles[3],
romance_titles[1], romance_titles[2], romance_titles[3])
cor(mob123_romance123,
use="pairwise.complete") |>
knitr::kable()
pr1_m1 <- qplot(r[,romance_idx[1]],
r[,mob_idx[1]],
xlab = romance_titles[1],
ylab = mob_titles[1])
pr2_m2 <- qplot(r[,romance_idx[2]],
r[,mob_idx[2]],
xlab = romance_titles[2],
ylab = mob_titles[2])
pr3_m3 <- qplot(r[,romance_idx[3]],
r[,mob_idx[3]],
xlab = romance_titles[3],
ylab = mob_titles[3])
grid.arrange(pr1_m1, pr2_m2 ,pr3_m3, ncol = 3)
q <- c(-1, -1, -1, 1, 1, 1)
idx <- c(mob_idx[1], mob_idx[2], mob_idx[3],
romance_idx[1], romance_idx[2], romance_idx[3])
mob_vs_romance_sample <- r[, idx]
colnames(mob_vs_romance_sample) <-
c(mob_titles[1], mob_titles[2], mob_titles[3],
romance_titles[1], romance_titles[2], romance_titles[3])
cor(mob_vs_romance_sample,
use="pairwise.complete") |>
knitr::kable()
mob_vs_romance_sample
p <- t(qr.solve(crossprod(q)) %*% t(q) %*% t(mob_vs_romance_sample))
str(p)
hist(p, breaks = seq(-2,2,0.1))
scent_of_woman_idx <-
# romance_movie_titles_idx &
str_detect(movie_titles$titles, "Scent of a Woman")
sum(scent_of_woman_idx)
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
# look_who_is_talking_now_idx
scent_of_woman_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
# [1] "Sleepless in Seattle (1993)"   "You've Got Mail (1998)"        "Look Who's Talking Now (1993)"
romance_idx <- which(romance_movie_idx)
romance_idx
romance_sample <- r[, romance_idx]
colnames(romance_sample) <- romance_titles
cor(romance_sample,
use="pairwise.complete") |>
knitr::kable()
idx <- c(mob_idx[1], mob_idx[2], mob_idx[3],
romance_idx[1], romance_idx[2], romance_idx[3])
mob_vs_romance_sample <- r[, idx]
colnames(mob_vs_romance_sample) <-
c(mob_titles[1], mob_titles[2], mob_titles[3],
romance_titles[1], romance_titles[2], romance_titles[3])
cor(mob_vs_romance_sample,
use="pairwise.complete") |>
knitr::kable()
p <- t(qr.solve(crossprod(q)) %*% t(q) %*% t(mob_vs_romance_sample))
hist(p, breaks = seq(-2,2,0.1))
romance_movie_idx <-
you_ve_got_mail_idx |
sleepless_in_seattle_idx |
look_who_is_talking_now_idx
sum(romance_movie_idx)
#> [1] 3
movie_titles[romance_movie_idx,]
#                             titles                  genres
# 754    Sleepless in Seattle (1993)    Comedy|Drama|Romance
# 818         You've Got Mail (1998)          Comedy|Romance
# 2981 Look Who's Talking Now (1993) Children|Comedy|Romance
romance_titles <- movie_titles[romance_movie_idx,1]
romance_titles
# [1] "Sleepless in Seattle (1993)"   "You've Got Mail (1998)"        "Look Who's Talking Now (1993)"
romance_idx <- which(romance_movie_idx)
romance_idx
romance_sample <- r[, romance_idx]
colnames(romance_sample) <- romance_titles
cor(romance_sample,
use="pairwise.complete") |>
knitr::kable()
idx <- c(mob_idx[1], mob_idx[2], mob_idx[3],
romance_idx[1], romance_idx[2], romance_idx[3])
mob_vs_romance_sample <- r[, idx]
colnames(mob_vs_romance_sample) <-
c(mob_titles[1], mob_titles[2], mob_titles[3],
romance_titles[1], romance_titles[2], romance_titles[3])
cor(mob_vs_romance_sample,
use="pairwise.complete") |>
knitr::kable()
p <- t(qr.solve(crossprod(q)) %*% t(q) %*% t(mob_vs_romance_sample))
hist(p, breaks = seq(-2,2,0.1))
plot(p %*% t(q), e)
p <- matrix(p); q <- matrix(q)
plot(p %*% t(q), mob_vs_romance_sample)
