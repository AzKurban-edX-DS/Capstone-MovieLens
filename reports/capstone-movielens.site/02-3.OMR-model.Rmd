## Overall Mean Rating (OMR) Model
\

Let's begin our analysis by evaluating the simplest model described in [Section 25.1 *Case study: recommendation systems / A first model*](https://rafalab.dfci.harvard.edu/dsbook-part-2/highdim/regularization.html#a-first-model) of the *Course Textbook (New Edition)*[@IDS2_25-1], and then gradually refine it through further research.

### Mathematical Description of the OMR Model
\

The _Overal Mean Rating_ model that assumes the same rating for all movies and users with all the differences explained by random variation would look as follows:

$$
Y_{i,j} = \mu + \varepsilon_{i,j}
$$

with $\varepsilon_{i,j}$ independent errors sampled from the same distribution centered at 0 and $\mu$ is the average rating for all movies.

### OMR Model Building
\

::: {.noteblock data-latex=""}
The complete source code of the *Overall Mean Rating* computation described in this section is available in the [Overall Mean Rating (Naive) Model](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L66) section of the [capstone-movielens.main.R](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L66) script on _GitHub_.
:::

We know that the estimate that minimizes the RMSE is the least squares estimate of $\mu$ and, in this case, is the average of all ratings:

```{r pressure, echo=TRUE}
mu <- mean(edx$rating)
print(mu)
```

If we predict all unknown ratings with $\hat{\mu}$, we can obtain RMSE as follows:: 
```{r}
mu.MSEs <- naive_model_MSEs(mu)
data.frame(fold_No = 1:5, MSE = mu.MSEs) |>
  data.plot(title = "MSE resuls of the 5-fold CV method applied to the Overall Mean Rating Model",
              xname = "fold_No", 
              yname = "MSE")

mu.RMSE <- sqrt(mean(mu.MSEs))
mu.RMSE
```

::: {.noteblock data-latex=""}

The following custom functions described in [Appendix A: Support Functions], are used in the code snippets above:

  - [naive_model_MSEs](#func.naive_model_MSEs) (described in section [OMR Model Helper Functions]) to compute _Mean Squared Errors_ using _5-Fold Cross Validation_ method;

  - [data.plot](#func.data.plot) (described in section [Data Visualization Functions]) for the _Mean Squared Errors_ data visualization.

:::

\newpage

### OMR Value Is the Best for the Current Model
\

If we plug in any other number, we will get a higher *RMSE*. Let's prove that by the following small investigation:
```{r }
  deviation <- seq(0, 6, 0.1) - 3

  deviation.RMSE <- sapply(deviation, function(delta){
    naive_model_RMSE(mu + delta)
  })
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the custom function [naive_model_RMSE](#func.naive_model_RMSE) described in the [OMR Model Helper Functions] section of [Appendix A: Support Functions] to calculate *RMSEs* for the sequence of the deviation values.
:::

Let's make a quick investigation of the `deviation.RMSE` result we have just got: 
```{r}
data.frame(delta = deviation, 
           delta.RMSE = deviation.RMSE) |> 
data.plot(title = TeX(r'[RMSE as a function of deviation ($\delta$) from the Overall Mean Rating ($\hat{mu}$)]'),
              xname = "delta", 
              yname = "delta.RMSE", 
              xlabel = TeX(r'[$\delta$]'), 
              ylabel = "RMSE")

which_min_deviation <- deviation[which.min(deviation.RMSE)]
min_rmse = min(deviation.RMSE)

print_log1("Minimum RMSE is achieved when the deviation from the mean is: %1",
         which_min_deviation)

print_log1("Is the previously computed RMSE the best for the current model: %1",
         mu.RMSE == min_rmse)
```

::: {.noteblock data-latex=""}
To print the log, we use the custom function [print_log1](#func.print_log1) described in the [Logging Functions] section of [Appendix A: Support Functions].
:::

```{r eval=FALSE}
RMSEs.ResultTibble.OMR <- RMSEs.ResultTibble |> 
  RMSEs.AddRow("Overall Mean Rating Model", mu.RMSE)
```
```{r}
RMSE_kable(RMSEs.ResultTibble.OMR)
```

::: {.noteblock data-latex=""}
To print the table above, we use the [RMSEs.AddRow](#func.RMSEs.AddRow) and [RMSE_kable](#func.RMSE_kable) custom functions described in the [Result RMSEs Tibble Functions] section of [Appendix A: Support Functions].
:::

To win the grand prize of $1,000,000, a participating team had to get an RMSE of at least 0.8563[@BigChaosSln]. So we can definitely do better![@IDS2_23-3]

\newpage
