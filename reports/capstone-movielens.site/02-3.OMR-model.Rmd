## Overall Mean Rating (OMR) Model
\

Let's begin our analysis by evaluating the simplest model described in [Section 33.7.4: *A first model*](https://rafalab.dfci.harvard.edu/dsbook/large-datasets.html#a-first-model) of the *Course Textbook (First Edition)*[@IDS_E1_33-7-4], and then gradually refine it through further research.

### Mathematical Description of the OMR Model
\

The _Overal Mean Rating_ model that assumes the same rating for all movies and users with all the differences explained by random variation would look as follows:

$$
Y_{i,j} = \mu + \varepsilon_{i,j}
$$

with $\varepsilon_{i,j}$ independent errors sampled from the same distribution centered at 0 and $\mu$ is the average rating for all movies.

### OMR Model Building
\

::: {.noteblock data-latex=""}
The complete source code of the *Overall Mean Rating* computation described in this section is available in the [Overall Mean Rating (Naive) Model](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L66) section of the [capstone-movielens.main.R](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L66) script on _GitHub_.
:::

We know that the estimate that minimizes the RMSE is the least squares estimate of $\mu$ and, in this case, is the average of all ratings. We calculate this using the following [line of code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L106):
```{r main-script@l106, echo=TRUE }
mu <- mean(edx$rating)
mu
```

If we predict all unknown ratings with $\hat{\mu}$, we can use the following [line of code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L108)  to compute *Mean Squared Errors* (hereafter *MSE* for short) with the use of *K-Fold Cross-Validation*, where the $K$ is the length of the [`edx_CV` Object] (described in detail in [Appendix B: Models Training Datasets]) to which the *K-Fold Cross-Validation* is applied (in *this Project*, we use $K = 5$): 
```{r main-script@l108 }
mu.MSEs <- naive_model_MSEs(mu)
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the user-defined function [naive_model_MSEs](#func.naive_model_MSEs) described in section [OMR Model: Helper Functions] of [Appendix A](#appndx_a).
:::

\newpage

The following [code snippet](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L110) provides a visual representation of the results we have just obtained:
```{r main-script@l110 }
data.frame(fold_No = 1:5, MSE = mu.MSEs) |>
  data.plot(title = "MSE resuls of the 5-fold CV method applied to the Overall Mean Rating Model",
              xname = "fold_No", 
              yname = "MSE")
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the custom data visualization function [data.plot](#func.data.plot) described in section [Data Visualization Functions] of [Appendix A](#appndx_a).
:::

We can now calculate the *Root Mean Squared Error (RMSE)* for the current model as a *square root* of the average of the *MSE* values we obtained above, using the following [line of code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L117):
```{r main-script@l117 }
mu.RMSE <- sqrt(mean(mu.MSEs))
mu.RMSE
```

\newpage

### OMR Value Is the Best for the Current Model
\

If we plug in any other number, we will get a higher *RMSE*. Let's prove this with a small experiment using the following [code snippet](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L155):
```{r main-script@l155 }
  deviation <- seq(0, 6, 0.1) - 3

  deviation.RMSE <- sapply(deviation, function(delta){
    naive_model_RMSE(mu + delta)
  })
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the function [naive_model_RMSE](#func.naive_model_RMSE) described in section [OMR Model: Helper Functions] of [Appendix A](#appndx_a) to calculate *RMSEs* for the sequence of the deviation values.
:::

\newpage

Let's quickly analyze the resulting `deviation.RMSE` vector we have just got. The following [data visualization code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L189) will help us with this:
```{r main-script@l189}
data.frame(delta = deviation, 
           delta.RMSE = deviation.RMSE) |> 
data.plot(title = TeX(r'[RMSE as a function of deviation ($\delta$) from the Overall Mean Rating ($\hat{mu}$)]'),
              xname = "delta", 
              yname = "delta.RMSE", 
              xlabel = TeX(r'[$\delta$]'), 
              ylabel = "RMSE")
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the custom data visualization function [data.plot](#func.data.plot) described in section [Data Visualization Functions] of [Appendix A](#appndx_a).
:::

\newpage

::: { #chunk.main_script.l177m .sidebar }
The [piece of code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L177) below prints a quick recap of the results:
```{r main-script@l177m}
which_min_deviation <- deviation[which.min(deviation.RMSE)]
min_rmse = min(deviation.RMSE)

print_log1("Minimum RMSE is achieved when the deviation from the mean is: %1",
         which_min_deviation)

print_log1("Is the previously computed RMSE the best for the current model: %1",
         mu.RMSE == min_rmse)
```
:::

::: {.noteblock data-latex=""}
To print the log, we use the function [print_log1](#func.print_log1) described in section [Logging Functions] of [Appendix A](#appndx_a).
:::

Finally, we add the *RMSE* value calculated for the *OMR Model* to our *Result Table* and print the table using the following [piece of code](https://github.com/AzKurban-edX-DS/Capstone-MovieLens/blob/main/r/src/capstone-movielens.main.R#L200):
```{r main-script@l200, eval=FALSE}
RMSEs.ResultTibble.OMR <- RMSEs.ResultTibble |> 
  RMSEs.AddRow("OMR Model", 
               mu.RMSE,
               comment = "Overall Mean Rating (OMR) Model")
```
```{r}
RMSE_kable(RMSEs.ResultTibble.OMR)
```

::: {.noteblock data-latex=""}
In the code snippet above, we use the [RMSEs.AddRow](#func.RMSEs.AddRow) and [RMSE_kable](#func.RMSE_kable) functions described in section [Result RMSEs Tibble Functions] of [Appendix A](#appndx_a).
:::

To win the grand prize of $1,000,000, a participating team had to get an RMSE of at least 0.8563[@BigChaosSln]. So we can definitely do better![@IDS_E1_33-7-4]

\newpage
